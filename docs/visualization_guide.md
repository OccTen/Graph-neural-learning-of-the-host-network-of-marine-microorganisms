# 微生物与宿主相互作用机制可视化指南

本文档介绍如何使用可视化工具分析微生物（噬菌体）与宿主之间的相互作用机制。

## 概述

微生物与宿主之间的相互作用是微生物生态学中的重要研究内容。通过对模型输出的预测结果进行可视化分析，我们可以揭示潜在的相互作用模式和机制。

## 可视化工具

`visualize_phage_host_interactions.py` 脚本提供了多种可视化方法，用于分析噬菌体与宿主之间的关系。

### 主要功能

1. **互作网络图**：展示噬菌体与宿主之间的潜在互作关系，边的粗细表示互作强度。
2. **互作热图**：直观显示噬菌体与宿主之间的匹配程度。
3. **特征空间分布**：使用降维技术（PCA + t-SNE）展示噬菌体和宿主在特征空间中的分布情况。
4. **分类学分布**：按类型和预测类别分析分类学模式。
5. **交互式网络**：创建可交互的网络可视化，支持缩放、拖动和悬停查看详细信息。

## 使用方法

### 命令行运行

```bash
python scripts/visualize_phage_host_interactions.py --input output/taxonomy_predictions.json --output output/interaction_analysis/ --interactive
```

### 参数说明

- `--input`：模型预测结果文件路径
- `--output`：可视化输出目录
- `--taxonomy_data`：分类学数据文件路径
- `--threshold`：匹配阈值（默认0.6）
- `--top_n`：展示前N个最重要的互作关系（默认20）
- `--interactive`：生成交互式可视化（需要安装pyvis库）

### 使用批处理文件

为了简化操作，您可以直接运行 `wrapper/visualize_interactions.bat` 批处理文件。

## 输出说明

脚本将在指定的输出目录生成以下文件：

1. `interaction_network.png`：噬菌体-宿主互作网络图
2. `interaction_heatmap.png`：噬菌体-宿主互作热图
3. `feature_embedding.png`：特征空间分布图
4. `taxonomy_distribution.png`：分类学分布图
5. `interactive_network.html`：交互式网络可视化（如果启用）

## 解读可视化结果

### 互作网络图

- **蓝色节点**：噬菌体
- **红色节点**：普通宿主（类别1）
- **绿色节点**：类别0宿主
- **紫色节点**：特殊宿主（类别2或更高）
- **边的粗细**：表示互作强度，越粗表示相互作用越强

### 特征空间分布

特征空间分布图通过降维技术将高维特征投影到二维空间，可以观察到：

- 相似实体会聚集在一起
- 不同类型/类别的实体会形成不同的簇
- 潜在的互作伙伴通常会在空间中靠近

### 分类学分布

分析不同类型实体的预测类别分布，帮助理解分类模式和可能的进化关系。

## 注意事项

1. 互作强度是基于简化的相似度计算，实际生物学匹配可能需要更专业的分析方法。
2. 交互式可视化需要安装pyvis库：`pip install pyvis`。
3. 对于大规模数据集，可能需要调整`--top_n`参数以获得更清晰的可视化效果。

## 应用场景

1. 发现潜在的宿主-微生物互作关系
2. 分析微生物群落结构
3. 揭示分类学模式和进化关系
4. 预测未知微生物的可能宿主 